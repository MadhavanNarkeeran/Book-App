{% extends "header.html" %}
{% block content %}
<div class="container">
    <div class="account-header">
        {% if image %}
            <img class="profile-image" src="data:image/png;base64,{{image}}" alt="Profile picture">
        {% endif %}
        <h2>Welcome, {{ current_user.username }}!</h2>
    </div>

    <div class="account-section">
        <h3>Update Username</h3>
        <form class="account-form" method="POST" action="">
            {{ update_username_form.csrf_token }}
            <div>
                {{ update_username_form.username.label }}
                {{ update_username_form.username() }}
                {% if update_username_form.username.errors %}
                <div class="error-message" role="alert">
                    {% for error in update_username_form.username.errors %}
                    <span>{{ error }}</span>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {{ update_username_form.submit_username() }}
        </form>
    </div>

    <div class="account-section">
        <h3>Update Profile Picture</h3>
        <form class="account-form" method="POST" action="" enctype="multipart/form-data">
            {{ update_profile_pic_form.csrf_token }}
            <div>
                {{ update_profile_pic_form.picture.label }}
                {{ update_profile_pic_form.picture() }}
                {% if update_profile_pic_form.picture.errors %}
                <div class="error-message" role="alert">
                    {% for error in update_profile_pic_form.picture.errors %}
                    <span>{{ error }}</span>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {{ update_profile_pic_form.submit_picture() }}
        </form>
    </div>

    <div class="account-link">
        <a href="{{ url_for('books.user_detail', username=current_user.username) }}">
            View all my reviews
        </a>
    </div>
</div>
{% endblock %}